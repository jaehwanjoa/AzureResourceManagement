{
    "properties": {
        "displayName": "가상 머신의 정보자산별 보안등급에 따라 접근 통제를 이행한다.",
        "policyType": "Custom",
        "mode": "Indexed",
        "description": "정보자산별 보안등급에 따라 워크로드 내 가상 머신은 관리자 및 사용자를 할당하고 액세스를 제어해야 합니다.",
        "metadata": {
            "category": "Tags"
        },
        "parameters": {
            "tagName": {
            "type": "String",
            "metadata": {
                "displayName": "태그 이름",
                "description": "태그의 이름을 서비스별로 정의(예: 'DB, Network, ERP, CRM등)"
            }
        },
            "tagValue": {
                "type": "array",
                "metadata": {
                    "displayName": "허용되는 보안 등급 태그 리스트 입니다.",
                    "description": "허용되는 보안 등급 태그 리스트 입니다."
                },
                "allowedValues": [
                    "High",
                    "Medium",
                    "Low"
                ]
            }
        },
        "policyRule": {
            "if": { //모든 조건이 True일 경우 effect 효과를 수행함
            "allOf": [
                {
                            "field": "type",
                            "equals": "Microsoft.Compute/virtualMachines"
                        },
                        {
                        "field": "[concat('tags[', parameters('tagName'), ']')]",
                        "notIn": "[parameters('tagValue')]"
                    }
            ]
            },
            "then": {
                "effect": "audit"
            }
        }
    }
}
